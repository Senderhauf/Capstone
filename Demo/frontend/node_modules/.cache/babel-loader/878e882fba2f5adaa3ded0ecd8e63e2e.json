{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Styler = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n/**\n *  Copyright (c) 2016, The Regents of the University of California,\n *  through Lawrence Berkeley National Laboratory (subject to receipt\n *  of any required approvals from the U.S. Dept. of Energy).\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree.\n */\n\n\nexports.default = styler;\n\nvar _underscore = require(\"underscore\");\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nvar _colorbrewer = require(\"colorbrewer\");\n\nvar _colorbrewer2 = _interopRequireDefault(_colorbrewer);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n/**\n * For our Style we want to represent two things:\n *\n *   1. The overall style of an AreaChart should be consistent across a site\n *   2. The specific style of a columnName (e.g. \"pressure\") should be consistent\n *\n * The overall style is implemented with methods specific to\n * each chart type or entity:\n *\n *   - lineChartStyle()\n *   - areaChartStyle()\n *   - legendStyle()\n *   - etc\n *\n * These will render out an object that can be passed into the\n * charts themselves and will control the visual appearance,\n * keyed by columnName. This abstracts away the SVG details of the\n * underlying DOM elements.\n *\n * For the specific style we define here three out of the box parameters\n * by which one column can be different from another when rendered:\n *   - color\n *   - width (of a line)\n *   - dashed or not\n *\n */\n\n\nvar Styler = exports.Styler = function () {\n  /**\n   * The columns define the style associated with a particular\n   * quantity, such as \"inTraffic\" or \"temperature\". The columns\n   * are an array, with each element being either a string, or\n   * and object defining the style.\n   *\n   *  * Using a string makes the assumption that you want to use a\n   * color scheme, so you need to define that if you don't want the\n   * default. A color will be then assigned to each column based\n   * on the scheme. The string is the column name.\n   *\n   *  * In the second case of providing an object, you define properties\n   * of the style yourself. Each object should contain a \"key\" property\n   * which is the column name and optionally the `width` and `dashed`\n   * property. If you don't supply the color, then the color\n   * will come from the scheme.\n   *\n   */\n  function Styler(columns) {\n    var _this = this;\n\n    var scheme = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"Paired\";\n\n    _classCallCheck(this, Styler);\n\n    this.columnStyles = {};\n\n    if (_underscore2.default.isArray(columns)) {\n      columns.forEach(function (column) {\n        if (_underscore2.default.isString(column)) {\n          _this.columnStyles[column] = {\n            key: column\n          };\n        } else if (_underscore2.default.isObject(column)) {\n          var key = column.key,\n              style = _objectWithoutProperties(column, [\"key\"]);\n\n          _this.columnStyles[key] = style;\n        }\n      });\n    }\n\n    this.columnNames = _underscore2.default.map(columns, function (c) {\n      var cc = _underscore2.default.isString(c) ? c : c.key;\n      return cc;\n    });\n\n    if (scheme && !_underscore2.default.has(_colorbrewer2.default, scheme)) {\n      throw new Error(\"Unknown scheme '\" + scheme + \"' supplied to Style constructor\");\n    }\n\n    this.colorScheme = scheme;\n  }\n\n  _createClass(Styler, [{\n    key: \"numColumns\",\n    value: function numColumns() {\n      return this.columnNames.length;\n    }\n    /**\n     * Returns the color scheme with the appropiate number of colors.\n     * If there are more columns than the largest set in the scheme then\n     * just the largest scheme set will be returned.\n     * If there are less columns than the smallest set in the scheme then\n     * just the smallest scheme will be returned.\n     * @param  {number} columnCount The number of columns to apply the scheme to\n     * @return {array}              An array with the scheme colors in it.\n     */\n\n  }, {\n    key: \"colorLookup\",\n    value: function colorLookup(columnCount) {\n      var colorSchemeKeys = _underscore2.default.keys(_colorbrewer2.default[this.colorScheme]);\n\n      var minSchemeSize = _underscore2.default.min(colorSchemeKeys);\n\n      var maxSchemeSize = _underscore2.default.max(colorSchemeKeys);\n\n      var colorLookupSize = columnCount > maxSchemeSize ? maxSchemeSize : columnCount;\n      colorLookupSize = _underscore2.default.max([colorLookupSize, minSchemeSize]);\n      return this.colorScheme ? _colorbrewer2.default[this.colorScheme][colorLookupSize] : [];\n    }\n    /**\n     */\n\n  }, {\n    key: \"legendStyle\",\n    value: function legendStyle(column, type) {\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n\n      var i = _underscore2.default.indexOf(this.columnNames, column);\n\n      var columnName = this.columnNames[i];\n      var _columnStyles$columnN = this.columnStyles[columnName],\n          color = _columnStyles$columnN.color,\n          _columnStyles$columnN2 = _columnStyles$columnN.width,\n          width = _columnStyles$columnN2 === undefined ? 1 : _columnStyles$columnN2,\n          _columnStyles$columnN3 = _columnStyles$columnN.dashed,\n          dashed = _columnStyles$columnN3 === undefined ? false : _columnStyles$columnN3;\n      var c = color || colorLookup[i % colorLookup.length];\n      var styleSymbol = {};\n\n      if (type === \"swatch\" || type === \"dot\") {\n        styleSymbol = {\n          fill: c,\n          opacity: 0.9,\n          stroke: c,\n          cursor: \"pointer\"\n        };\n      } else if (type === \"line\") {\n        styleSymbol = {\n          opacity: 0.9,\n          stroke: c,\n          strokeWidth: width,\n          cursor: \"pointer\"\n        };\n\n        if (dashed) {\n          styleSymbol.strokeDasharray = \"4,2\";\n        }\n      }\n\n      var labelStyle = {\n        fontSize: \"normal\",\n        color: \"#333\",\n        paddingRight: 10,\n        cursor: \"pointer\"\n      };\n      var valueStyle = {\n        fontSize: \"smaller\",\n        color: \"#999\",\n        cursor: \"pointer\"\n      };\n      var legendStyle = {\n        symbol: {\n          normal: _extends({}, styleSymbol, {\n            opacity: 0.7\n          }),\n          highlighted: _extends({}, styleSymbol, {\n            opacity: 0.8\n          }),\n          selected: _extends({}, styleSymbol, {\n            opacity: 0.8\n          }),\n          muted: _extends({}, styleSymbol, {\n            opacity: 0.2\n          })\n        },\n        label: {\n          normal: _extends({}, labelStyle, {\n            opacity: 0.7\n          }),\n          highlighted: _extends({}, labelStyle, {\n            opacity: 0.8\n          }),\n          selected: _extends({}, labelStyle, {\n            opacity: 0.8\n          }),\n          muted: _extends({}, labelStyle, {\n            opacity: 0.5\n          })\n        },\n        value: {\n          normal: _extends({}, valueStyle, {\n            opacity: 0.7\n          }),\n          highlighted: _extends({}, valueStyle, {\n            opacity: 0.8\n          }),\n          selected: _extends({}, valueStyle, {\n            opacity: 0.8\n          }),\n          muted: _extends({}, valueStyle, {\n            opacity: 0.5\n          })\n        }\n      };\n      return legendStyle;\n    }\n  }, {\n    key: \"areaChartStyle\",\n    value: function areaChartStyle() {\n      var style = {};\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n      var i = 0;\n\n      _underscore2.default.forEach(this.columnStyles, function (_ref, column) {\n        var color = _ref.color,\n            selected = _ref.selected,\n            _ref$width = _ref.width,\n            width = _ref$width === undefined ? 1 : _ref$width,\n            _ref$dashed = _ref.dashed,\n            dashed = _ref$dashed === undefined ? false : _ref$dashed;\n        var c = color || colorLookup[i % colorLookup.length];\n        var styleLine = {\n          stroke: c,\n          fill: \"none\",\n          strokeWidth: width\n        };\n        var styleSelectedLine = {\n          stroke: selected || color,\n          fill: \"none\",\n          strokeWidth: width\n        };\n\n        if (dashed) {\n          styleLine.strokeDasharray = \"4,2\";\n        }\n\n        var styleArea = {\n          fill: c,\n          stroke: \"none\"\n        };\n        var styleSelectedArea = {\n          fill: selected || color,\n          stroke: \"none\"\n        };\n        style[column] = {\n          line: {\n            normal: _extends({}, styleLine, {\n              opacity: 0.9\n            }),\n            highlighted: _extends({}, styleLine, {\n              opacity: 1.0\n            }),\n            selected: _extends({}, styleSelectedLine, {\n              opacity: 1.0\n            }),\n            muted: _extends({}, styleLine, {\n              opacity: 0.4\n            })\n          },\n          area: {\n            normal: _extends({}, styleArea, {\n              opacity: 0.7\n            }),\n            highlighted: _extends({}, styleArea, {\n              opacity: 0.8\n            }),\n            selected: _extends({}, styleSelectedArea, {\n              opacity: 0.8\n            }),\n            muted: _extends({}, styleArea, {\n              opacity: 0.2\n            })\n          }\n        };\n        i += 1;\n      });\n\n      return style;\n    }\n  }, {\n    key: \"lineChartStyle\",\n    value: function lineChartStyle() {\n      var _this2 = this;\n\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n      var style = {};\n\n      _underscore2.default.forEach(this.columnStyles, function (_ref2, column) {\n        var color = _ref2.color,\n            selected = _ref2.selected,\n            _ref2$width = _ref2.width,\n            width = _ref2$width === undefined ? 1 : _ref2$width,\n            _ref2$dashed = _ref2.dashed,\n            dashed = _ref2$dashed === undefined ? false : _ref2$dashed;\n\n        var i = _underscore2.default.indexOf(_this2.columnNames, column);\n\n        var c = color || colorLookup[i % colorLookup.length];\n        var styleLine = {\n          stroke: c,\n          strokeWidth: width,\n          fill: \"none\"\n        };\n        var styleSelectedLine = {\n          stroke: selected || c,\n          strokeWidth: width,\n          fill: \"none\"\n        };\n\n        if (dashed) {\n          styleLine.strokeDasharray = \"4,2\";\n        }\n\n        style[column] = {\n          normal: _extends({}, styleLine, {\n            opacity: 0.8,\n            strokeWidth: width\n          }),\n          highlighted: _extends({}, styleLine, {\n            opacity: 1.0,\n            strokeWidth: width\n          }),\n          selected: _extends({}, styleSelectedLine, {\n            opacity: 1.0,\n            strokeWidth: width\n          }),\n          muted: _extends({}, styleLine, {\n            opacity: 0.2,\n            strokeWidth: width\n          })\n        };\n      });\n\n      return style;\n    }\n  }, {\n    key: \"barChartStyle\",\n    value: function barChartStyle() {\n      var _this3 = this;\n\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n      var style = {};\n\n      _underscore2.default.forEach(this.columnStyles, function (_ref3, column) {\n        var color = _ref3.color,\n            selected = _ref3.selected;\n\n        var i = _underscore2.default.indexOf(_this3.columnNames, column);\n\n        var c = color || colorLookup[i % colorLookup.length];\n        var fillStyle = {\n          fill: c\n        };\n        var selectedStyle = {\n          fill: selected || c\n        };\n        style[column] = {\n          normal: _extends({}, fillStyle, {\n            opacity: 0.8\n          }),\n          highlighted: _extends({}, fillStyle, {\n            opacity: 1.0\n          }),\n          selected: _extends({}, selectedStyle, {\n            opacity: 1.0\n          }),\n          muted: _extends({}, fillStyle, {\n            opacity: 0.2\n          })\n        };\n      });\n\n      return style;\n    }\n  }, {\n    key: \"scatterChartStyle\",\n    value: function scatterChartStyle() {\n      var _this4 = this;\n\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n      var style = {};\n\n      _underscore2.default.forEach(this.columnStyles, function (_ref4, column) {\n        var color = _ref4.color,\n            selected = _ref4.selected;\n\n        var i = _underscore2.default.indexOf(_this4.columnNames, column);\n\n        var c = color || colorLookup[i % colorLookup.length];\n        var fillStyle = {\n          fill: c\n        };\n        var selectedStyle = {\n          fill: selected || c\n        };\n        style[column] = {\n          normal: _extends({}, fillStyle, {\n            opacity: 0.8\n          }),\n          highlighted: _extends({}, fillStyle, {\n            opacity: 1.0\n          }),\n          selected: _extends({}, selectedStyle, {\n            opacity: 1.0\n          }),\n          muted: _extends({}, fillStyle, {\n            opacity: 0.2\n          })\n        };\n      });\n\n      return style;\n    }\n  }, {\n    key: \"axisStyle\",\n    value: function axisStyle(column) {\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n\n      var i = _underscore2.default.indexOf(this.columnNames, column);\n\n      var columnName = this.columnNames[i];\n      var color = this.columnStyles[columnName].color;\n      var c = color || colorLookup[i % colorLookup.length];\n      return {\n        label: {\n          fill: c\n        }\n      };\n    }\n  }, {\n    key: \"boxChartStyle\",\n    value: function boxChartStyle() {\n      var style = {};\n      var numColumns = this.numColumns();\n      var colorLookup = this.colorLookup(numColumns);\n      var i = 0;\n\n      _underscore2.default.forEach(this.columnStyles, function (_ref5, column) {\n        var color = _ref5.color,\n            selected = _ref5.selected;\n        var c = color || colorLookup[i % colorLookup.length];\n        var styleArea = {\n          fill: c,\n          stroke: \"none\"\n        };\n        var styleSelectedArea = {\n          fill: selected || color,\n          stroke: \"none\"\n        };\n        style[column] = [{\n          normal: _extends({}, styleArea, {\n            opacity: 0.2\n          }),\n          highlighted: _extends({}, styleArea, {\n            opacity: 0.3\n          }),\n          selected: _extends({}, styleSelectedArea, {\n            opacity: 0.3\n          }),\n          muted: _extends({}, styleArea, {\n            opacity: 0.1\n          })\n        }, {\n          normal: _extends({}, styleArea, {\n            opacity: 0.5\n          }),\n          highlighted: _extends({}, styleArea, {\n            opacity: 0.6\n          }),\n          selected: _extends({}, styleSelectedArea, {\n            opacity: 0.6\n          }),\n          muted: _extends({}, styleArea, {\n            opacity: 0.2\n          })\n        }, {\n          normal: _extends({}, styleArea, {\n            opacity: 0.9\n          }),\n          highlighted: _extends({}, styleArea, {\n            opacity: 1.0\n          }),\n          selected: _extends({}, styleSelectedArea, {\n            opacity: 1.0\n          }),\n          muted: _extends({}, styleArea, {\n            opacity: 0.2\n          })\n        }];\n        i += 1;\n      });\n\n      return style;\n    }\n  }]);\n\n  return Styler;\n}();\n\nfunction styler(columns, scheme) {\n  return new Styler(columns, scheme);\n}","map":null,"metadata":{},"sourceType":"script"}