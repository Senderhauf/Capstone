{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _underscore = require(\"underscore\");\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nvar _merge = require(\"merge\");\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _pondjs = require(\"pondjs\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/**\n *  Copyright (c) 2015-present, The Regents of the University of California,\n *  through Lawrence Berkeley National Laboratory (subject to receipt\n *  of any required approvals from the U.S. Dept. of Energy).\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree.\n */\n\n/**\n * Renders an event view that shows the supplied set of events along a time axis.\n * The events should be supplied as a Pond TimeSeries.\n * That series may contain regular TimeEvents, TimeRangeEvents\n * or IndexedEvents.\n */\n\n\nvar EventChart = function (_React$Component) {\n  _inherits(EventChart, _React$Component);\n\n  function EventChart(props) {\n    _classCallCheck(this, EventChart);\n\n    var _this = _possibleConstructorReturn(this, (EventChart.__proto__ || Object.getPrototypeOf(EventChart)).call(this, props));\n\n    _this.state = {\n      hover: null\n    };\n    return _this;\n  }\n  /**\n   * Continues a hover event on a specific bar of the bar chart.\n   */\n\n\n  _createClass(EventChart, [{\n    key: \"onMouseOver\",\n    value: function onMouseOver(e, event) {\n      if (this.props.onMouseOver) {\n        this.props.onMouseOver(event);\n      }\n\n      this.setState({\n        hover: event\n      });\n    }\n    /**\n     * Handle mouse leave and calls onMouseLeave callback if one is provided\n     */\n\n  }, {\n    key: \"onMouseLeave\",\n    value: function onMouseLeave() {\n      if (this.props.onMouseLeave) {\n        this.props.onMouseLeave(this.state.hover);\n      }\n\n      this.setState({\n        hover: null\n      });\n    }\n    /**\n     * Handle click will call the onSelectionChange callback if one is provided\n     * as a prop. It will be called with the event selected.\n     */\n\n  }, {\n    key: \"handleClick\",\n    value: function handleClick(e, event) {\n      e.stopPropagation();\n\n      if (this.props.onSelectionChange) {\n        this.props.onSelectionChange(event);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          series = _props.series,\n          textOffsetX = _props.textOffsetX,\n          textOffsetY = _props.textOffsetY,\n          hoverMarkerWidth = _props.hoverMarkerWidth;\n      var scale = this.props.timeScale;\n      var eventMarkers = []; // Create and array of markers, one for each event\n\n      var i = 0;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var event = _step.value;\n          var begin = event.begin();\n          var end = event.end();\n          var beginPos = scale(begin) >= 0 ? scale(begin) : 0;\n          var endPos = scale(end) <= _this2.props.width ? scale(end) : _this2.props.width;\n          var transform = \"translate(\" + beginPos + \",0)\";\n          var isHover = _this2.state.hover ? _pondjs.Event.is(event, _this2.state.hover) : false;\n          var state = void 0;\n\n          if (isHover) {\n            state = \"hover\";\n          } else {\n            state = \"normal\";\n          }\n\n          var barNormalStyle = {};\n          var barStyle = {};\n\n          if (_this2.props.style) {\n            barNormalStyle = _this2.props.style(event, \"normal\");\n            barStyle = _this2.props.style(event, state);\n          }\n\n          var label = \"\";\n\n          if (_this2.props.label) {\n            if (_underscore2.default.isString(_this2.props.label)) {\n              label = _this2.props.label;\n            } else if (_underscore2.default.isFunction(_this2.props.label)) {\n              label = _this2.props.label(event);\n            }\n          }\n\n          var x = _this2.props.spacing;\n          var y = 0;\n          var width = endPos - beginPos - 2 * _this2.props.spacing;\n          width = width < 0 ? 0 : width;\n          var height = _this2.props.size;\n          var eventLabelStyle = {\n            fontWeight: 100,\n            fontSize: 11\n          };\n          var text = null;\n\n          if (isHover) {\n            text = _react2.default.createElement(\"g\", null, _react2.default.createElement(\"rect\", {\n              className: \"eventchart-marker\",\n              x: x,\n              y: y,\n              width: hoverMarkerWidth,\n              height: height + 4,\n              style: (0, _merge2.default)(true, barNormalStyle, {\n                pointerEvents: \"none\"\n              })\n            }), _react2.default.createElement(\"text\", {\n              style: _extends({\n                pointerEvents: \"none\",\n                fill: \"#444\"\n              }, eventLabelStyle),\n              x: 8 + textOffsetX,\n              y: 15 + textOffsetY\n            }, label));\n          }\n\n          eventMarkers.push(_react2.default.createElement(\"g\", {\n            transform: transform,\n            key: i\n          }, _react2.default.createElement(\"rect\", {\n            className: \"eventchart-marker\",\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n            style: barStyle,\n            onClick: function onClick(e) {\n              return _this2.handleClick(e, event);\n            },\n            onMouseLeave: function onMouseLeave() {\n              return _this2.onMouseLeave();\n            },\n            onMouseOver: function onMouseOver(e) {\n              return _this2.onMouseOver(e, event);\n            }\n          }), text));\n          i += 1;\n        };\n\n        for (var _iterator = series.events()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return _react2.default.createElement(\"g\", null, eventMarkers);\n    }\n  }]);\n\n  return EventChart;\n}(_react2.default.Component);\n\nexports.default = EventChart;\nEventChart.defaultProps = {\n  visible: true,\n  size: 30,\n  spacing: 0,\n  textOffsetX: 0,\n  textOffsetY: 0,\n  hoverMarkerWidth: 5\n};\nEventChart.propTypes = {\n  /**\n   * Show or hide this chart\n   */\n  visible: _propTypes2.default.bool,\n\n  /**\n   * What [Pond TimeSeries](https://esnet-pondjs.appspot.com/#/timeseries) data to visualize\n   */\n  series: _propTypes2.default.instanceOf(_pondjs.TimeSeries).isRequired,\n\n  /**\n   * Set hover label text\n   * When label is function callback it will be called with current event.\n   */\n  label: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.func]),\n\n  /**\n   * The height in pixels for the event bar\n   */\n  size: _propTypes2.default.number,\n\n  /**\n   * The distance in pixels to inset the event bar from its actual timerange\n   */\n  spacing: _propTypes2.default.number,\n\n  /**\n   * Marker width on hover\n   */\n  hoverMarkerWidth: _propTypes2.default.number,\n\n  /**\n   * Hover text offset position X\n   */\n  textOffsetX: _propTypes2.default.number,\n\n  /**\n   * Hover text offset position Y\n   */\n  textOffsetY: _propTypes2.default.number,\n\n  /**\n   * A function that should return the style of the event box\n   */\n  style: _propTypes2.default.func,\n\n  /**\n   * Event selection on click. Will be called with selected event.\n   */\n  onSelectionChange: _propTypes2.default.func,\n\n  /**\n   * Mouse leave at end of hover event\n   */\n  onMouseLeave: _propTypes2.default.func,\n\n  /**\n   * Mouse over event callback\n   */\n  onMouseOver: _propTypes2.default.func,\n\n  /**\n   * [Internal] The timeScale supplied by the surrounding ChartContainer\n   */\n  timeScale: _propTypes2.default.func,\n\n  /**\n   * [Internal] The width supplied by the surrounding ChartContainer\n   */\n  width: _propTypes2.default.number\n};","map":null,"metadata":{},"sourceType":"script"}