{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _underscore = require(\"underscore\");\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _merge = require(\"merge\");\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nvar _pondjs = require(\"pondjs\");\n\nvar _d3TimeFormat = require(\"d3-time-format\");\n\nvar _Label = require(\"./Label\");\n\nvar _Label2 = _interopRequireDefault(_Label);\n\nvar _ValueList = require(\"./ValueList\");\n\nvar _ValueList2 = _interopRequireDefault(_ValueList);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/**\n *  Copyright (c) 2016, The Regents of the University of California,\n *  through Lawrence Berkeley National Laboratory (subject to receipt\n *  of any required approvals from the U.S. Dept. of Energy).\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree.\n */\n\n\nvar EventTime = function EventTime(_ref) {\n  var time = _ref.time,\n      _ref$format = _ref.format,\n      format = _ref$format === undefined ? \"%m/%d/%y %X\" : _ref$format;\n  var textStyle = {\n    fontSize: 11,\n    textAnchor: \"left\",\n    fill: \"#bdbdbd\",\n    pointerEvents: \"none\"\n  };\n  var text = void 0;\n\n  if (_underscore2.default.isFunction(format)) {\n    text = format(time);\n  } else {\n    var fmt = (0, _d3TimeFormat.timeFormat)(format);\n    text = fmt(time);\n  }\n\n  return _react2.default.createElement(\"text\", {\n    x: 0,\n    y: 0,\n    dy: \"1.2em\",\n    style: textStyle\n  }, text);\n};\n\nEventTime.propTypes = {\n  time: _propTypes2.default.instanceOf(Date),\n  format: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string])\n};\nEventTime.defaultProps = {\n  infoTimeFormat: \"%m/%d/%y %X\"\n};\n\nvar EventTimeRange = function EventTimeRange(_ref2) {\n  var timerange = _ref2.timerange,\n      _ref2$format = _ref2.format,\n      format = _ref2$format === undefined ? \"%m/%d/%y %X\" : _ref2$format;\n  var textStyle = {\n    fontSize: 11,\n    textAnchor: \"left\",\n    fill: \"#bdbdbd\",\n    pointerEvents: \"none\"\n  };\n  var d1 = timerange.begin();\n  var d2 = timerange.end();\n  var beginText = void 0;\n  var endText = void 0;\n\n  if (_underscore2.default.isFunction(format)) {\n    beginText = format(d1);\n    endText = format(d2);\n  } else {\n    var fmt = (0, _d3TimeFormat.timeFormat)(format);\n    beginText = fmt(d1);\n    endText = fmt(d2);\n  }\n\n  return _react2.default.createElement(\"text\", {\n    x: 0,\n    y: 0,\n    dy: \"1.2em\",\n    style: textStyle\n  }, beginText + \" to \" + endText);\n};\n\nEventTimeRange.propTypes = {\n  timerange: _propTypes2.default.instanceOf(_pondjs.TimeRange),\n  format: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string])\n};\nEventTimeRange.defaultProps = {\n  infoTimeFormat: \"%m/%d/%y %X\"\n};\n\nvar EventIndex = function EventIndex(_ref3) {\n  var index = _ref3.index,\n      format = _ref3.format;\n  var textStyle = {\n    fontSize: 11,\n    textAnchor: \"left\",\n    fill: \"#bdbdbd\",\n    pointerEvents: \"none\"\n  };\n  var text = void 0;\n\n  if (_underscore2.default.isFunction(format)) {\n    text = format(index);\n  } else if (_underscore2.default.isString(format)) {\n    var fmt = (0, _d3TimeFormat.timeFormat)(format);\n    text = fmt(index.begin());\n  } else {\n    text = index.toString();\n  }\n\n  return _react2.default.createElement(\"text\", {\n    x: 0,\n    y: 0,\n    dy: \"1.2em\",\n    style: textStyle\n  }, text);\n};\n\nEventIndex.propTypes = {\n  index: _propTypes2.default.instanceOf(_pondjs.Index),\n  format: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string])\n};\n/**\n * Renders a marker at a specific event on the chart.\n *\n * To explain how EventMarkers work, it's useful to explain a little\n * terminology used here. A marker has several parts:\n *\n *  * the \"marker\" itself which appears at the (value, time) of the event.\n *    This is a dot which whose radius is defined by markerRadius, and\n *    whose style is set with markerStyle\n *  * the \"markerLabel\" which is a string that will be rendered next to\n *    the marker. The label can be aligned with markerAlign and also\n *    styled with markerLabelStyle\n *  * the \"info box\" which is a box containing values that hovers that the\n *    top of the chart. Optionally it can show the time above the box.\n *    The values themselves are supplied as an array of objects using\n *    the `info` prop. The info box can be styled with `infoStyle`,\n *    sized with `infoWidth` and `infoHeight`, and the time formatted\n *    with `infoTimeFormat`\n *  * the \"stem\" which is a connector between the marker and the\n *    info box to visually link the two\n *\n * Combining these attributes, Event markers fall into two flavors, either\n * you want to omit the infoBox and mark the event with a dot and optionally\n * a label, or you want to omit the label (and perhaps marker dot) and show\n * a flag style marker with the infoBox connected to the event with the stem.\n *\n * As with other IndexedEvents or TimeRangeEvents, the marker will appear at\n * the center of the timerange represented by that event. You can, however,\n * override either the x or y position by a number of pixels.\n */\n\nvar EventMarker = function (_React$Component) {\n  _inherits(EventMarker, _React$Component);\n\n  function EventMarker() {\n    _classCallCheck(this, EventMarker);\n\n    return _possibleConstructorReturn(this, (EventMarker.__proto__ || Object.getPrototypeOf(EventMarker)).apply(this, arguments));\n  }\n\n  _createClass(EventMarker, [{\n    key: \"renderTime\",\n    value: function renderTime(event) {\n      if (event instanceof _pondjs.TimeEvent) {\n        return _react2.default.createElement(EventTime, {\n          time: event.timestamp(),\n          format: this.props.infoTimeFormat\n        });\n      } else if (event instanceof _pondjs.IndexedEvent) {\n        return _react2.default.createElement(EventIndex, {\n          index: event.index(),\n          format: this.props.infoTimeFormat\n        });\n      } else if (event instanceof _pondjs.TimeRangeEvent) {\n        return _react2.default.createElement(EventTimeRange, {\n          timerange: event.timerange(),\n          format: this.props.infoTimeFormat\n        });\n      }\n\n      return _react2.default.createElement(\"g\", null);\n    }\n  }, {\n    key: \"renderMarker\",\n    value: function renderMarker(event, column, info) {\n      var t = void 0;\n\n      if (event instanceof _pondjs.TimeEvent) {\n        t = event.timestamp();\n      } else {\n        t = new Date(event.begin().getTime() + (event.end().getTime() - event.begin().getTime()) / 2);\n      }\n\n      var value = void 0;\n\n      if (this.props.yValueFunc) {\n        value = this.props.yValueFunc(event, column);\n      } else {\n        value = event.get(column);\n      } // Allow overrides on the x and y position. This is useful for the barchart\n      // tracker because bars maybe be offset from their actual event position in\n      // order to display them side by side.\n\n\n      var posx = this.props.timeScale(t) + this.props.offsetX;\n      var posy = this.props.yScale(value) - this.props.offsetY;\n      var infoBoxProps = {\n        align: \"left\",\n        style: this.props.infoStyle,\n        width: this.props.infoWidth,\n        height: this.props.infoHeight\n      };\n      var w = this.props.infoWidth;\n      var lineBottom = posy - 10;\n      var verticalStem = void 0;\n      var horizontalStem = void 0;\n      var dot = void 0;\n      var infoBox = void 0;\n      var transform = void 0;\n      var label = void 0;\n\n      if (info) {\n        if (_underscore2.default.isString(this.props.info)) {\n          infoBox = _react2.default.createElement(_Label2.default, _extends({}, infoBoxProps, {\n            label: info\n          }));\n        } else {\n          infoBox = _react2.default.createElement(_ValueList2.default, _extends({}, infoBoxProps, {\n            values: info\n          }));\n        }\n      } //\n      // Marker on right of event\n      //\n\n\n      if (this.props.type === \"point\") {\n        var textDefaultStyle = {\n          fontSize: 11,\n          pointerEvents: \"none\",\n          paintOrder: \"stroke\",\n          fill: \"#b0b0b0\",\n          strokeWidth: 2,\n          strokeLinecap: \"butt\",\n          strokeLinejoin: \"miter\",\n          fontWeight: 800\n        };\n        var dx = 0;\n        var dy = 0;\n\n        switch (this.props.markerLabelAlign) {\n          case \"left\":\n            dx = 5;\n            textDefaultStyle.textAnchor = \"start\";\n            textDefaultStyle.alignmentBaseline = \"central\";\n            break;\n\n          case \"right\":\n            dx = -5;\n            textDefaultStyle.textAnchor = \"end\";\n            textDefaultStyle.alignmentBaseline = \"central\";\n            break;\n\n          case \"top\":\n            dy = -5;\n            textDefaultStyle.textAnchor = \"middle\";\n            textDefaultStyle.alignmentBaseline = \"bottom\";\n            break;\n\n          case \"bottom\":\n            dy = 5;\n            textDefaultStyle.textAnchor = \"middle\";\n            textDefaultStyle.alignmentBaseline = \"hanging\";\n            break;\n\n          default: //pass\n\n        }\n\n        var tstyle = (0, _merge2.default)(true, textDefaultStyle, this.props.markerLabelStyle);\n        dot = _react2.default.createElement(\"circle\", {\n          cx: posx,\n          cy: posy,\n          r: this.props.markerRadius,\n          pointerEvents: \"none\",\n          style: this.props.markerStyle\n        });\n        label = _react2.default.createElement(\"text\", {\n          x: posx,\n          y: posy,\n          dx: dx,\n          dy: dy,\n          style: tstyle\n        }, this.props.markerLabel);\n        return _react2.default.createElement(\"g\", null, dot, label);\n      } else {\n        if (posx + 10 + w < this.props.width * 3 / 4) {\n          if (info) {\n            verticalStem = _react2.default.createElement(\"line\", {\n              pointerEvents: \"none\",\n              style: this.props.stemStyle,\n              x1: -10,\n              y1: lineBottom,\n              x2: -10,\n              y2: 20\n            });\n            horizontalStem = _react2.default.createElement(\"line\", {\n              pointerEvents: \"none\",\n              style: this.props.stemStyle,\n              x1: -10,\n              y1: 20,\n              x2: -2,\n              y2: 20\n            });\n          }\n\n          dot = _react2.default.createElement(\"circle\", {\n            cx: -10,\n            cy: lineBottom,\n            r: this.props.markerRadius,\n            pointerEvents: \"none\",\n            style: this.props.markerStyle\n          });\n          transform = \"translate(\" + (posx + 10) + \",\" + 10 + \")\";\n        } else {\n          if (info) {\n            verticalStem = _react2.default.createElement(\"line\", {\n              pointerEvents: \"none\",\n              style: this.props.stemStyle,\n              x1: w + 10,\n              y1: lineBottom,\n              x2: w + 10,\n              y2: 20\n            });\n            horizontalStem = _react2.default.createElement(\"line\", {\n              pointerEvents: \"none\",\n              style: this.props.stemStyle,\n              x1: w + 10,\n              y1: 20,\n              x2: w + 2,\n              y2: 20\n            });\n          }\n\n          dot = _react2.default.createElement(\"circle\", {\n            cx: w + 10,\n            cy: lineBottom,\n            r: this.props.markerRadius,\n            pointerEvents: \"none\",\n            style: this.props.markerStyle\n          });\n          transform = \"translate(\" + (posx - w - 10) + \",\" + 10 + \")\";\n        }\n\n        return _react2.default.createElement(\"g\", {\n          transform: transform\n        }, verticalStem, horizontalStem, dot, this.renderTime(event), _react2.default.createElement(\"g\", {\n          transform: \"translate(0,\" + 20 + \")\"\n        }, infoBox));\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props = this.props,\n          event = _props.event,\n          column = _props.column,\n          info = _props.info;\n\n      if (!event) {\n        return _react2.default.createElement(\"g\", null);\n      }\n\n      return _react2.default.createElement(\"g\", null, this.renderMarker(event, column, info));\n    }\n  }]);\n\n  return EventMarker;\n}(_react2.default.Component);\n\nexports.default = EventMarker;\nEventMarker.propTypes = {\n  type: _propTypes2.default.oneOf([\"point\", \"flag\"]),\n\n  /**\n   * What [Pond Event](https://esnet-pondjs.appspot.com/#/event) to mark\n   */\n  event: _propTypes2.default.oneOfType([_propTypes2.default.instanceOf(_pondjs.TimeEvent), _propTypes2.default.instanceOf(_pondjs.IndexedEvent), _propTypes2.default.instanceOf(_pondjs.TimeRangeEvent)]),\n\n  /**\n   * Which column in the Event to use\n   *\n   * NOTE : Columns can't have periods because periods\n   * represent a path to deep data in the underlying events\n   * (i.e. reference into nested data structures)\n   */\n  column: _propTypes2.default.string,\n\n  /**\n   * The values to show in the info box. This is either an array of\n   * objects, with each object specifying the label and value\n   * to be shown in the info box, or a simple string label. If this\n   * prop is not supplied, no infoBox will be displayed.\n   */\n  info: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.arrayOf(_propTypes2.default.shape({\n    label: _propTypes2.default.string,\n    // eslint-disable-line\n    value: _propTypes2.default.string // eslint-disable-line\n\n  }))]),\n\n  /**\n   * The style of the info box itself. Typically you'd want to\n   * specify a fill color, and stroke color/width here.\n   */\n  infoStyle: _propTypes2.default.object,\n\n  /**\n   * The width of the info box\n   */\n  infoWidth: _propTypes2.default.number,\n\n  /**\n   * The height of the info box\n   */\n  infoHeight: _propTypes2.default.number,\n\n  /**\n   * Alter the format of the timestamp shown on the info box.\n   * This may be either a function or a string. If you provide a function\n   * that will be passed an Index and should return a string. For example:\n   * ```\n   *     index => moment(index.begin()).format(\"Do MMM 'YY\")\n   * ```\n   * Alternatively you can pass in a d3 format string. That will be applied\n   * to the begin time of the Index range.\n   */\n  infoTimeFormat: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string]),\n\n  /**\n   * Show a label to the left or right of the marker\n   */\n  markerLabelAlign: _propTypes2.default.oneOf([\"left\", \"right\", \"top\", \"bottom\"]),\n\n  /**\n   * The radius of the dot at the end of the marker\n   */\n  markerRadius: _propTypes2.default.number,\n\n  /**\n   * The style of the event marker dot\n   */\n  markerStyle: _propTypes2.default.object,\n\n  /**\n   * The y value is calculated by the column and event, but if\n   * this prop is provided this will be used instead.\n   */\n  yValueFunc: _propTypes2.default.func,\n\n  /**\n   * Offset the marker position in the x direction.\n   */\n  offsetX: _propTypes2.default.number,\n\n  /**\n   * Offset the marker position in the y direction\n   */\n  offsetY: _propTypes2.default.number,\n\n  /**\n   * [Internal] The timeScale supplied by the surrounding ChartContainer\n   */\n  timeScale: _propTypes2.default.func,\n\n  /**\n   * [Internal] The yScale supplied by the associated YAxis\n   */\n  yScale: _propTypes2.default.func,\n\n  /**\n   * [Internal] The width supplied by the surrounding ChartContainer\n   */\n  width: _propTypes2.default.number\n};\nEventMarker.defaultProps = {\n  type: \"flag\",\n  column: \"value\",\n  infoWidth: 90,\n  infoHeight: 25,\n  infoStyle: {\n    fill: \"white\",\n    opacity: 0.9,\n    stroke: \"#999\",\n    pointerEvents: \"none\"\n  },\n  stemStyle: {\n    stroke: \"#999\",\n    cursor: \"crosshair\",\n    pointerEvents: \"none\"\n  },\n  markerStyle: {\n    fill: \"#999\"\n  },\n  markerRadius: 2,\n  markerLabelAlign: \"left\",\n  markerLabelStyle: {\n    fill: \"#999\"\n  },\n  offsetX: 0,\n  offsetY: 0\n};","map":null,"metadata":{},"sourceType":"script"}